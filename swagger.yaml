openapi: 3.0.3
info:
  title: Prestasi API
  description: API Specification sesuai SRS Project UAS
  version: 1.0.0

servers:
  - url: http://localhost:3000
    description: Local server

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

security:
  - BearerAuth: []

paths:
  /api/v1/auth/login:
    post:
      tags: [Auth]
      summary: Login user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                password:
                  type: string
      responses:
        '200': { description: Login success }
        '400': { description: Wrong password }
        '404': { description: User not found }

  /api/v1/auth/refresh:
    post:
      tags: [Auth]
      summary: Refresh access token
      responses:
        '200': { description: Token refreshed }
        '401': { description: Invalid refresh token }

  /api/v1/auth/logout:
    post:
      tags: [Auth]
      summary: Logout user
      security:
        - BearerAuth: []
      responses:
        '200': { description: Logout success }

  /api/v1/auth/profile:
    get:
      tags: [Auth]
      summary: Get user profile
      security:
        - BearerAuth: []
      responses:
        '200': { description: Profile data }
        '401': { description: Unauthorized }

  /api/v1/achievements:
    get:
      tags: [Achievement]
      summary: List achievements (by role)
      responses:
        '200': { description: List achievements }
    post:
      tags: [Achievement]
      summary: Create achievement
      responses:
        '200': { description: Achievement created }

  /api/v1/achievements/{refId}:
    get:
      tags: [Achievement]
      summary: Get achievement detail
      parameters:
        - name: refId
          in: path
          required: true
          schema: { type: string }
      responses:
        '200': { description: Achievement detail }
    put:
      tags: [Achievement]
      summary: Update achievement (draft only)
      responses:
        '200': { description: Achievement updated }
    delete:
      tags: [Achievement]
      summary: Delete achievement
      responses:
        '200': { description: Achievement deleted }

  /api/v1/achievements/{refId}/submit:
    post:
      tags: [Achievement]
      summary: Submit achievement
      responses:
        '200': { description: Submitted }

  /api/v1/achievements/{refId}/verify:
    post:
      tags: [Achievement]
      summary: Verify achievement
      responses:
        '200': { description: Verified }

  /api/v1/achievements/{refId}/reject:
    post:
      tags: [Achievement]
      summary: Reject achievement
      responses:
        '200': { description: Rejected }

  /api/v1/achievements/{refId}/attachments:
    post:
      tags: [Achievement]
      summary: Upload attachment
      responses:
        '200': { description: Attachment uploaded }

  /api/v1/achievements/{refId}/history:
    get:
      tags: [Achievement]
      summary: Get achievement history
      responses:
        '200': { description: History list }

  /api/v1/lecturers:
    get:
      tags: [Lecturer]
      summary: List lecturers
      responses:
        '200': { description: List lecturers }

  /api/v1/lecturers/{id}/advisees:
    get:
      tags: [Lecturer]
      summary: List lecturer advisees
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string }
      responses:
        '200': { description: List advisees }

  /api/v1/students:
    get:
      tags: [Student]
      summary: List students
      responses:
        '200': { description: List students }

  /api/v1/students/{id}:
    get:
      tags: [Student]
      summary: Student detail
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string }
      responses:
        '200': { description: Student detail }

  /api/v1/students/{id}/achievements:
    get:
      tags: [Student]
      summary: Student achievements
      responses:
        '200': { description: Student achievements }

  /api/v1/students/{id}/advisor:
    put:
      tags: [Student]
      summary: Assign advisor
      responses:
        '200': { description: Advisor assigned }

  /api/v1/users:
    get:
      tags: [User]
      summary: List users
      responses:
        '200': { description: List users }
    post:
      tags: [User]
      summary: Create user
      responses:
        '200': { description: User created }

  /api/v1/users/{id}:
    get:
      tags: [User]
      summary: User detail
      responses:
        '200': { description: User detail }
    put:
      tags: [User]
      summary: Update user
      responses:
        '200': { description: User updated }
    delete:
      tags: [User]
      summary: Delete user
      responses:
        '200': { description: User deleted }

  /api/v1/users/{id}/role:
    put:
      tags: [User]
      summary: Change user role
      responses:
        '200': { description: Role updated }

  /api/v1/reports/statistics:
    get:
      tags: [Report]
      summary: Get achievement statistics
      responses:
        '200': { description: Statistics data }

  /api/v1/reports/student/{id}:
    get:
      tags: [Report]
      summary: Get student report
      responses:
        '200': { description: Student report }
